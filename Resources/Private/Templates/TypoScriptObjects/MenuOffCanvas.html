{namespace neos=TYPO3\Neos\ViewHelpers}
{namespace ts=TYPO3\TypoScript\ViewHelpers}

<f:render section="itemsList" arguments="{items: items}" />


<f:section name="itemsList">
  <f:for each="{items}" as="item">
    <f:if condition="{item.state} != 'normal'">
		<f:then>
        	<li>
        	<neos:link.node node="{item.node}" class="item active {item.state} {f:if(condition:'{item.subItems}',then:'hasSub',else:' ')}">
        		{item.label}
        	</neos:link.node>
            <f:if condition="{item.subItems}">
                <ul><f:render section="itemsList" arguments="{items: item.subItems}" /></ul>
            </f:if>
        	</li>
		</f:then>
		<f:else>
		    <li>
        	<neos:link.node node="{item.node}" class="item normal {item.state} {f:if(condition:'{item.subItems}',then:'hasSub',else:' ')}">
        		{item.label}
        	</neos:link.node>
            <f:if condition="{item.subItems}">
                <ul><f:render section="itemsList" arguments="{items: item.subItems}" /></ul>
            </f:if>
		    </li>
		</f:else>
	</f:if>
  </f:for>
</f:section>